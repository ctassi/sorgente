<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="it"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../../../.resources/report.css" type="text/css"/><link rel="shortcut icon" href="../../../.resources/report.gif" type="image/gif"/><title>DAOManagementProcessUserTest.java</title><link rel="stylesheet" href="../../../.resources/prettify.css" type="text/css"/><script type="text/javascript" src="../../../.resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../../../.sessions.html" class="el_session">Sessions</a></span><a href="../../../index.html" class="el_report">seq (1) (2-lug-2014 22.31.08)</a> &gt; <a href="../../index.html" class="el_group">seq</a> &gt; <a href="../index.html" class="el_bundle">src/test/java</a> &gt; <a href="index.source.html" class="el_package">com.sequenziatore.server.databaseutil.dao</a> &gt; <span class="el_source">DAOManagementProcessUserTest.java</span></div><h1>DAOManagementProcessUserTest.java</h1><pre class="source lang-java linenums">/*
 * Copyright 2014 Dainese Matteo, De Nadai Andrea, Girotto Giacomo, Pavanello Mirko, Romagnosi Nicolò, Sartoretto Massimiliano, Visentin Luca
 *
 * Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

/**
 * 	File contentente la classe DAOManagementProcessUserTest
 * 
 *	@file		DAOManagementProcessUserTest.java
 *	@author		DeSQ
 *	@date		2014-05-14
 *	@version	1.0
 */

package com.sequenziatore.server.databaseutil.dao;

import static org.junit.Assert.*;

import java.util.ArrayList;
import java.util.GregorianCalendar;
import java.util.List;

import org.hibernate.Query;
import org.junit.AfterClass;
import org.junit.Before;
import org.junit.Test;

import com.sequenziatore.server.databaseutil.util.HibernateUtil;
import com.sequenziatore.server.entity.DataCollection;
import com.sequenziatore.server.entity.Process;
import com.sequenziatore.server.entity.Step;
import com.sequenziatore.server.entity.DataCollection.EnumState;
import com.sequenziatore.server.entity.Step.EnumParallelism;
import com.sequenziatore.server.entity.Subscription;
import com.sequenziatore.server.entity.User;

/**
 *	Classe contenente tutti i test di unità dei metodi della classe DAOManagementProcessUser.
 *
 *	@author 	DeSQ
 */
<span class="fc" id="L53">public class DAOManagementProcessUserTest {</span>
	
	/**
	 * Pulisce il database prima di iniziare ad eseguire i test.
	 * @throws Exception segnala un problema di connessione al database
	 */
	@Before
	public void clean() throws Exception
	{
		//pulizia database
<span class="fc" id="L63">	    HibernateUtil.getSession().beginTransaction();</span>
	    
	    //elimina le data collection
<span class="fc" id="L66">	    Query deleteDataCollection = HibernateUtil.getSession().createQuery(&quot;delete DataCollection&quot;);</span>
<span class="fc" id="L67">	    deleteDataCollection.executeUpdate();</span>
	    
	    //elimina le iscrizioni ai processi
<span class="fc" id="L70">	    Query unsubscribeToProcess = HibernateUtil.getSession().createQuery(&quot;delete Subscription&quot;);</span>
<span class="fc" id="L71">	    unsubscribeToProcess.executeUpdate();</span>
	    
	    //elimina i passi di tutti i processi
<span class="fc" id="L74">	    Query deleteTestStep = HibernateUtil.getSession().createQuery(&quot;delete Step&quot;);</span>
<span class="fc" id="L75">	    deleteTestStep.executeUpdate();</span>
	    
	    //elimina i processi
<span class="fc" id="L78">	    Query deleteTestProcess = HibernateUtil.getSession().createQuery(&quot;delete Process&quot;);</span>
<span class="fc" id="L79">	    deleteTestProcess.executeUpdate();</span>
	    
	    //elimina gli utenti registrati
<span class="fc" id="L82">	    Query deleteTestUser = HibernateUtil.getSession().createQuery(&quot;delete User&quot;);</span>
<span class="fc" id="L83">	    deleteTestUser.executeUpdate();</span>
	    
<span class="fc" id="L85">	    HibernateUtil.commitTransaction();</span>
<span class="fc" id="L86">	}</span>
	
	/**
	 *	Pulisce il database quando sono terminati tutti i test.
	 * @throws Exception segnala un problema di connessione al database
	 */
	@AfterClass
	public static void finalClean() throws Exception
	{
		//pulizia database
<span class="fc" id="L96">	    HibernateUtil.getSession().beginTransaction();</span>
	    
	    //elimina le data collection
<span class="fc" id="L99">	    Query deleteDataCollection = HibernateUtil.getSession().createQuery(&quot;delete DataCollection&quot;);</span>
<span class="fc" id="L100">	    deleteDataCollection.executeUpdate();</span>
	    
	    //elimina le iscrizioni ai processi
<span class="fc" id="L103">	    Query unsubscribeToProcess = HibernateUtil.getSession().createQuery(&quot;delete Subscription&quot;);</span>
<span class="fc" id="L104">	    unsubscribeToProcess.executeUpdate();</span>
	    
	    //elimina i passi di tutti i processi
<span class="fc" id="L107">	    Query deleteTestStep = HibernateUtil.getSession().createQuery(&quot;delete Step&quot;);</span>
<span class="fc" id="L108">	    deleteTestStep.executeUpdate();</span>
	    
	    //elimina i processi
<span class="fc" id="L111">	    Query deleteTestProcess = HibernateUtil.getSession().createQuery(&quot;delete Process&quot;);</span>
<span class="fc" id="L112">	    deleteTestProcess.executeUpdate();</span>
	    
	    //elimina gli utenti registrati
<span class="fc" id="L115">	    Query deleteTestUser = HibernateUtil.getSession().createQuery(&quot;delete User&quot;);</span>
<span class="fc" id="L116">	    deleteTestUser.executeUpdate();</span>
	    
<span class="fc" id="L118">	    HibernateUtil.commitTransaction();</span>
<span class="fc" id="L119">	}</span>
    
	/**
	 *	Test del metodo findClosedSuccessSubscription() che ritorna gli id delle iscrizioni ai processi attualmente chiusi a cui l'utente ha partecipato con successo.
	 * @throws Exception segnala un problema di connessione al database
	 */
	@Test
	public void testFindClosedSuccessSubscription() throws Exception {
<span class="fc" id="L127">		DAOManagementProcessUser daoManagementProcessUserObject = new DAOManagementProcessUser();</span>
    	
    	//creazione ambiente per l'esecuzione della query
<span class="fc" id="L130">    	HibernateUtil.getSession().beginTransaction();</span>
    	
    	//creazione amministratore
<span class="fc" id="L133">        User testAdmin = new User();</span>
<span class="fc" id="L134">        testAdmin.setEmail(&quot;asd@asd.com&quot;);</span>
<span class="fc" id="L135">        testAdmin.setIsAdmin(true);</span>
<span class="fc" id="L136">        testAdmin.setPassword(&quot;test&quot;);</span>
<span class="fc" id="L137">        testAdmin.setUsername(&quot;testAdmin&quot;);</span>
<span class="fc" id="L138">        HibernateUtil.getSession().saveOrUpdate(testAdmin);</span>
    	
    	//creazione utente
<span class="fc" id="L141">        User testUser = new User();</span>
<span class="fc" id="L142">        testUser.setEmail(&quot;asd@asd.com&quot;);</span>
<span class="fc" id="L143">        testUser.setIsAdmin(false);</span>
<span class="fc" id="L144">        testUser.setPassword(&quot;test&quot;);</span>
<span class="fc" id="L145">        testUser.setUsername(&quot;testUser&quot;);</span>
<span class="fc" id="L146">        HibernateUtil.getSession().saveOrUpdate(testUser);</span>
        
        //creazione processo
<span class="fc" id="L149">        Process testProcess = new Process();</span>
<span class="fc" id="L150">        testProcess.setAdmin(testAdmin);</span>
<span class="fc" id="L151">        testProcess.setAvailable(false);</span>
<span class="fc" id="L152">        testProcess.setDescription(&quot;Processo di test&quot;);</span>
<span class="fc" id="L153">        testProcess.setEndSubscriptionDate(new GregorianCalendar(2020,12,31,23,59,59));</span>
<span class="fc" id="L154">        testProcess.setClosingDate(new GregorianCalendar(2020,12,31,23,59,59));</span>
<span class="fc" id="L155">        testProcess.setName(&quot;test&quot;);</span>
<span class="fc" id="L156">        testProcess.setPublicationDate(new GregorianCalendar(2012,12,31,23,59,59));</span>
<span class="fc" id="L157">        testProcess.setTotalLevel(1);</span>
<span class="fc" id="L158">        HibernateUtil.getSession().saveOrUpdate(testProcess);</span>
        
        //creazione di un passo per il processo
<span class="fc" id="L161">        Step testStep = new Step();</span>
<span class="fc" id="L162">        testStep.setAdminVerify(false);</span>
<span class="fc" id="L163">        testStep.setDescription(&quot;test&quot;);</span>
<span class="fc" id="L164">        testStep.setCheckText(&quot;null&quot;);</span>
<span class="fc" id="L165">        testStep.setIsGeolocation(false);</span>
<span class="fc" id="L166">        testStep.setIsPhoto(false);</span>
<span class="fc" id="L167">        testStep.setIsText(false);</span>
<span class="fc" id="L168">        testStep.setLevel(1);</span>
<span class="fc" id="L169">        testStep.setParallelism(EnumParallelism.AND);</span>
<span class="fc" id="L170">        testStep.setIdProcess(testProcess);</span>
<span class="fc" id="L171">        HibernateUtil.getSession().saveOrUpdate(testStep);</span>
        
        //inserimento del passo nel processo
<span class="fc" id="L174">        List&lt;Step&gt; testStepList = new ArrayList&lt;Step&gt;();</span>
<span class="fc" id="L175">        testStepList.add(testStep);</span>
<span class="fc" id="L176">        testProcess.setSteps(testStepList);</span>
<span class="fc" id="L177">        HibernateUtil.getSession().saveOrUpdate(testProcess);</span>
        
        //iscrizione dell'utente al processo 
<span class="fc" id="L180">        Subscription testSubscription = new Subscription();</span>
<span class="fc" id="L181">        testSubscription.setComplete(true);</span>
<span class="fc" id="L182">        testSubscription.setIdUser(testUser);</span>
<span class="fc" id="L183">        testSubscription.setIdProcess(testProcess);</span>
<span class="fc" id="L184">        HibernateUtil.getSession().saveOrUpdate(testSubscription);</span>
        
        //creazione di una data collection
<span class="fc" id="L187">        DataCollection testCollection = new DataCollection();</span>
<span class="fc" id="L188">        testCollection.setState(EnumState.VERIFIED);</span>
<span class="fc" id="L189">        testCollection.setIdStep(testStep);</span>
<span class="fc" id="L190">        testCollection.setIdUser(testUser);</span>
<span class="fc" id="L191">        testCollection.setPhoto(&quot;null&quot;);</span>
<span class="fc" id="L192">        testCollection.setText(&quot;null&quot;);</span>
<span class="fc" id="L193">        testCollection.setLongitude(&quot;null&quot;);</span>
<span class="fc" id="L194">        testCollection.setLatitude(&quot;null&quot;);</span>
<span class="fc" id="L195">        HibernateUtil.getSession().saveOrUpdate(testCollection);        </span>
<span class="fc" id="L196">	    HibernateUtil.commitTransaction();</span>
	    
<span class="fc" id="L198">	    User userObject = new User();</span>
<span class="fc" id="L199">	    userObject.setIdUser(testUser.getIdUser());</span>
	    
<span class="fc" id="L201">        HibernateUtil.getSession().beginTransaction();</span>
<span class="fc" id="L202">	    List&lt;Integer&gt; subscriptionIdList = daoManagementProcessUserObject.findClosedSuccessSubscription(userObject);</span>
<span class="fc" id="L203">	    HibernateUtil.commitTransaction();</span>
	    
<span class="fc" id="L205">	    assertEquals(subscriptionIdList.get(0), testSubscription.getIdSubscription());</span>
<span class="fc" id="L206">	}</span>
	
	/**
	 * 	Test del metodo deleteSubscription() che elimina l'iscrizione di un utente ad un processo.
	 * @throws Exception segnala un problema di connessione al database
	 */
	@Test
	public void testDeleteSubscription() throws Exception {
<span class="fc" id="L214">		DAOManagementProcessUser daoManagementProcessUserObject = new DAOManagementProcessUser();</span>
    	
    	//creazione ambiente per l'esecuzione della query
<span class="fc" id="L217">    	HibernateUtil.getSession().beginTransaction();</span>
    	
    	//creazione amministratore
<span class="fc" id="L220">        User testAdmin = new User();</span>
<span class="fc" id="L221">        testAdmin.setEmail(&quot;asd@asd.com&quot;);</span>
<span class="fc" id="L222">        testAdmin.setIsAdmin(true);</span>
<span class="fc" id="L223">        testAdmin.setPassword(&quot;test&quot;);</span>
<span class="fc" id="L224">        testAdmin.setUsername(&quot;testAdmin&quot;);</span>
<span class="fc" id="L225">        HibernateUtil.getSession().saveOrUpdate(testAdmin);</span>
    	
    	//creazione utente
<span class="fc" id="L228">        User testUser = new User();</span>
<span class="fc" id="L229">        testUser.setEmail(&quot;asd@asd.com&quot;);</span>
<span class="fc" id="L230">        testUser.setIsAdmin(false);</span>
<span class="fc" id="L231">        testUser.setPassword(&quot;test&quot;);</span>
<span class="fc" id="L232">        testUser.setUsername(&quot;testUser&quot;);</span>
<span class="fc" id="L233">        HibernateUtil.getSession().saveOrUpdate(testUser);</span>
        
        //creazione processo
<span class="fc" id="L236">        Process testProcess = new Process();</span>
<span class="fc" id="L237">        testProcess.setAdmin(testAdmin);</span>
<span class="fc" id="L238">        testProcess.setAvailable(false);</span>
<span class="fc" id="L239">        testProcess.setDescription(&quot;Processo di test&quot;);</span>
<span class="fc" id="L240">        testProcess.setEndSubscriptionDate(new GregorianCalendar(2020,12,31,23,59,59));</span>
<span class="fc" id="L241">        testProcess.setClosingDate(new GregorianCalendar(2020,12,31,23,59,59));</span>
<span class="fc" id="L242">        testProcess.setName(&quot;test&quot;);</span>
<span class="fc" id="L243">        testProcess.setPublicationDate(new GregorianCalendar(2012,12,31,23,59,59));</span>
<span class="fc" id="L244">        testProcess.setTotalLevel(1);</span>
<span class="fc" id="L245">        HibernateUtil.getSession().saveOrUpdate(testProcess);</span>
        
        //creazione di un passo per il processo
<span class="fc" id="L248">        Step testStep = new Step();</span>
<span class="fc" id="L249">        testStep.setAdminVerify(false);</span>
<span class="fc" id="L250">        testStep.setDescription(&quot;test&quot;);</span>
<span class="fc" id="L251">        testStep.setCheckText(&quot;null&quot;);</span>
<span class="fc" id="L252">        testStep.setIsGeolocation(false);</span>
<span class="fc" id="L253">        testStep.setIsPhoto(false);</span>
<span class="fc" id="L254">        testStep.setIsText(false);</span>
<span class="fc" id="L255">        testStep.setLevel(1);</span>
<span class="fc" id="L256">        testStep.setParallelism(EnumParallelism.AND);</span>
<span class="fc" id="L257">        testStep.setIdProcess(testProcess);</span>
<span class="fc" id="L258">        HibernateUtil.getSession().saveOrUpdate(testStep);</span>
        
        //inserimento del passo nel processo
<span class="fc" id="L261">        List&lt;Step&gt; testStepList = new ArrayList&lt;Step&gt;();</span>
<span class="fc" id="L262">        testStepList.add(testStep);</span>
<span class="fc" id="L263">        testProcess.setSteps(testStepList);</span>
<span class="fc" id="L264">        HibernateUtil.getSession().saveOrUpdate(testProcess);</span>
        
        //iscrizione dell'utente al processo 
<span class="fc" id="L267">        Subscription testSubscription = new Subscription();</span>
<span class="fc" id="L268">        testSubscription.setComplete(false);</span>
<span class="fc" id="L269">        testSubscription.setIdUser(testUser);</span>
<span class="fc" id="L270">        testSubscription.setIdProcess(testProcess);</span>
<span class="fc" id="L271">        HibernateUtil.getSession().saveOrUpdate(testSubscription);</span>
        
        //creazione di una data collection
<span class="fc" id="L274">        DataCollection testCollection = new DataCollection();</span>
<span class="fc" id="L275">        testCollection.setState(EnumState.NOTCOLLECTED);</span>
<span class="fc" id="L276">        testCollection.setIdStep(testStep);</span>
<span class="fc" id="L277">        testCollection.setIdUser(testUser);</span>
<span class="fc" id="L278">        testCollection.setPhoto(&quot;null&quot;);</span>
<span class="fc" id="L279">        testCollection.setText(&quot;null&quot;);</span>
<span class="fc" id="L280">        testCollection.setLongitude(&quot;null&quot;);</span>
<span class="fc" id="L281">        testCollection.setLatitude(&quot;null&quot;);</span>
<span class="fc" id="L282">        HibernateUtil.getSession().saveOrUpdate(testCollection);        </span>
<span class="fc" id="L283">	    HibernateUtil.commitTransaction();</span>
	    
<span class="fc" id="L285">	    HibernateUtil.getSession().beginTransaction();</span>
<span class="fc" id="L286">	    daoManagementProcessUserObject.deleteSubscription(testUser, testProcess);</span>
<span class="fc" id="L287">	    assertEquals(0, daoManagementProcessUserObject.findActiveProcess(testUser).size());</span>
<span class="fc" id="L288">	    HibernateUtil.commitTransaction();</span>
<span class="fc" id="L289">	}</span>
	
	/**
	 * 	Test del metodo deleteDataCollection() 
	 * @throws Exception segnala un problema di connessione al database
	 */
	@Test
	public void testDeleteDataCollection() throws Exception {
<span class="fc" id="L297">		DAOManagementProcessUser daoManagementProcessUserObject = new DAOManagementProcessUser();</span>
    	
    	//creazione ambiente per l'esecuzione della query
<span class="fc" id="L300">    	HibernateUtil.getSession().beginTransaction();</span>
    	
    	//creazione amministratore
<span class="fc" id="L303">        User testAdmin = new User();</span>
<span class="fc" id="L304">        testAdmin.setEmail(&quot;asd@asd.com&quot;);</span>
<span class="fc" id="L305">        testAdmin.setIsAdmin(true);</span>
<span class="fc" id="L306">        testAdmin.setPassword(&quot;test&quot;);</span>
<span class="fc" id="L307">        testAdmin.setUsername(&quot;testAdmin&quot;);</span>
<span class="fc" id="L308">        HibernateUtil.getSession().saveOrUpdate(testAdmin);</span>
    	
    	//creazione utente
<span class="fc" id="L311">        User testUser = new User();</span>
<span class="fc" id="L312">        testUser.setEmail(&quot;asd@asd.com&quot;);</span>
<span class="fc" id="L313">        testUser.setIsAdmin(false);</span>
<span class="fc" id="L314">        testUser.setPassword(&quot;test&quot;);</span>
<span class="fc" id="L315">        testUser.setUsername(&quot;testUser&quot;);</span>
<span class="fc" id="L316">        HibernateUtil.getSession().saveOrUpdate(testUser);</span>
        
        //creazione processo
<span class="fc" id="L319">        Process testProcess = new Process();</span>
<span class="fc" id="L320">        testProcess.setAdmin(testAdmin);</span>
<span class="fc" id="L321">        testProcess.setAvailable(false);</span>
<span class="fc" id="L322">        testProcess.setDescription(&quot;Processo di test&quot;);</span>
<span class="fc" id="L323">        testProcess.setEndSubscriptionDate(new GregorianCalendar(2020,12,31,23,59,59));</span>
<span class="fc" id="L324">        testProcess.setClosingDate(new GregorianCalendar(2020,12,31,23,59,59));</span>
<span class="fc" id="L325">        testProcess.setName(&quot;test&quot;);</span>
<span class="fc" id="L326">        testProcess.setPublicationDate(new GregorianCalendar(2012,12,31,23,59,59));</span>
<span class="fc" id="L327">        testProcess.setTotalLevel(1);</span>
<span class="fc" id="L328">        HibernateUtil.getSession().saveOrUpdate(testProcess);</span>
        
        //creazione di un passo per il processo
<span class="fc" id="L331">        Step testStep = new Step();</span>
<span class="fc" id="L332">        testStep.setAdminVerify(false);</span>
<span class="fc" id="L333">        testStep.setDescription(&quot;test&quot;);</span>
<span class="fc" id="L334">        testStep.setCheckText(&quot;null&quot;);</span>
<span class="fc" id="L335">        testStep.setIsGeolocation(false);</span>
<span class="fc" id="L336">        testStep.setIsPhoto(false);</span>
<span class="fc" id="L337">        testStep.setIsText(false);</span>
<span class="fc" id="L338">        testStep.setLevel(1);</span>
<span class="fc" id="L339">        testStep.setParallelism(EnumParallelism.AND);</span>
<span class="fc" id="L340">        testStep.setIdProcess(testProcess);</span>
<span class="fc" id="L341">        HibernateUtil.getSession().saveOrUpdate(testStep);</span>
        
        //inserimento del passo nel processo
<span class="fc" id="L344">        List&lt;Step&gt; testStepList = new ArrayList&lt;Step&gt;();</span>
<span class="fc" id="L345">        testStepList.add(testStep);</span>
<span class="fc" id="L346">        testProcess.setSteps(testStepList);</span>
<span class="fc" id="L347">        HibernateUtil.getSession().saveOrUpdate(testProcess);</span>
        
        //iscrizione dell'utente al processo 
<span class="fc" id="L350">        Subscription testSubscription = new Subscription();</span>
<span class="fc" id="L351">        testSubscription.setComplete(false);</span>
<span class="fc" id="L352">        testSubscription.setIdUser(testUser);</span>
<span class="fc" id="L353">        testSubscription.setIdProcess(testProcess);</span>
<span class="fc" id="L354">        HibernateUtil.getSession().saveOrUpdate(testSubscription);</span>
        
        //creazione di una data collection
<span class="fc" id="L357">        DataCollection testCollection = new DataCollection();</span>
<span class="fc" id="L358">        testCollection.setState(EnumState.NOTCOLLECTED);</span>
<span class="fc" id="L359">        testCollection.setIdStep(testStep);</span>
<span class="fc" id="L360">        testCollection.setIdUser(testUser);</span>
<span class="fc" id="L361">        testCollection.setPhoto(&quot;null&quot;);</span>
<span class="fc" id="L362">        testCollection.setText(&quot;null&quot;);</span>
<span class="fc" id="L363">        testCollection.setLongitude(&quot;null&quot;);</span>
<span class="fc" id="L364">        testCollection.setLatitude(&quot;null&quot;);</span>
<span class="fc" id="L365">        HibernateUtil.getSession().saveOrUpdate(testCollection);        </span>
<span class="fc" id="L366">	    HibernateUtil.commitTransaction();</span>
	    
<span class="fc" id="L368">	    HibernateUtil.getSession().beginTransaction();</span>
<span class="fc" id="L369">	    daoManagementProcessUserObject.deleteDataCollection(testUser, testStep);</span>
<span class="fc" id="L370">	    assertNull(daoManagementProcessUserObject.findDataCollection(testUser, testStep));</span>
<span class="fc" id="L371">	    HibernateUtil.commitTransaction();</span>
<span class="fc" id="L372">	}</span>
	
	/**
	 *	Test del metodo findAllClosedSubscription() che ritorna gli id delle iscrizioni ai processi attualmente chiusi a cui l'utente ha partecipato.
	 * @throws Exception segnala un problema di connessione al database
	 */
	@Test
	public void testFindAllClosedSubscription() throws Exception {
<span class="fc" id="L380">		DAOManagementProcessUser daoManagementProcessUserObject = new DAOManagementProcessUser();</span>
    	
    	//creazione ambiente per l'esecuzione della query
<span class="fc" id="L383">    	HibernateUtil.getSession().beginTransaction();</span>
    	
    	//creazione amministratore
<span class="fc" id="L386">        User testAdmin = new User();</span>
<span class="fc" id="L387">        testAdmin.setEmail(&quot;asd@asd.com&quot;);</span>
<span class="fc" id="L388">        testAdmin.setIsAdmin(true);</span>
<span class="fc" id="L389">        testAdmin.setPassword(&quot;test&quot;);</span>
<span class="fc" id="L390">        testAdmin.setUsername(&quot;testAdmin&quot;);</span>
<span class="fc" id="L391">        HibernateUtil.getSession().saveOrUpdate(testAdmin);</span>
    	
    	//creazione utente
<span class="fc" id="L394">        User testUser = new User();</span>
<span class="fc" id="L395">        testUser.setEmail(&quot;asd@asd.com&quot;);</span>
<span class="fc" id="L396">        testUser.setIsAdmin(false);</span>
<span class="fc" id="L397">        testUser.setPassword(&quot;test&quot;);</span>
<span class="fc" id="L398">        testUser.setUsername(&quot;testUser&quot;);</span>
<span class="fc" id="L399">        HibernateUtil.getSession().saveOrUpdate(testUser);</span>
        
        //creazione processo
<span class="fc" id="L402">        Process testProcess = new Process();</span>
<span class="fc" id="L403">        testProcess.setAdmin(testAdmin);</span>
<span class="fc" id="L404">        testProcess.setAvailable(false);</span>
<span class="fc" id="L405">        testProcess.setDescription(&quot;Processo di test&quot;);</span>
<span class="fc" id="L406">        testProcess.setEndSubscriptionDate(new GregorianCalendar(2020,12,31,23,59,59));</span>
<span class="fc" id="L407">        testProcess.setClosingDate(new GregorianCalendar(2020,12,31,23,59,59));</span>
<span class="fc" id="L408">        testProcess.setName(&quot;test&quot;);</span>
<span class="fc" id="L409">        testProcess.setPublicationDate(new GregorianCalendar(2012,12,31,23,59,59));</span>
<span class="fc" id="L410">        testProcess.setTotalLevel(1);</span>
<span class="fc" id="L411">        HibernateUtil.getSession().saveOrUpdate(testProcess);</span>
        
        //creazione di un passo per il processo
<span class="fc" id="L414">        Step testStep = new Step();</span>
<span class="fc" id="L415">        testStep.setAdminVerify(false);</span>
<span class="fc" id="L416">        testStep.setDescription(&quot;test&quot;);</span>
<span class="fc" id="L417">        testStep.setCheckText(&quot;null&quot;);</span>
<span class="fc" id="L418">        testStep.setIsGeolocation(false);</span>
<span class="fc" id="L419">        testStep.setIsPhoto(false);</span>
<span class="fc" id="L420">        testStep.setIsText(false);</span>
<span class="fc" id="L421">        testStep.setLevel(1);</span>
<span class="fc" id="L422">        testStep.setParallelism(EnumParallelism.AND);</span>
<span class="fc" id="L423">        testStep.setIdProcess(testProcess);</span>
<span class="fc" id="L424">        HibernateUtil.getSession().saveOrUpdate(testStep);</span>
        
        //inserimento del passo nel processo
<span class="fc" id="L427">        List&lt;Step&gt; testStepList = new ArrayList&lt;Step&gt;();</span>
<span class="fc" id="L428">        testStepList.add(testStep);</span>
<span class="fc" id="L429">        testProcess.setSteps(testStepList);</span>
<span class="fc" id="L430">        HibernateUtil.getSession().saveOrUpdate(testProcess);</span>
        
        //iscrizione dell'utente al processo 
<span class="fc" id="L433">        Subscription testSubscription = new Subscription();</span>
<span class="fc" id="L434">        testSubscription.setComplete(false);</span>
<span class="fc" id="L435">        testSubscription.setIdUser(testUser);</span>
<span class="fc" id="L436">        testSubscription.setIdProcess(testProcess);</span>
<span class="fc" id="L437">        HibernateUtil.getSession().saveOrUpdate(testSubscription);</span>
        
        //creazione di una data collection
<span class="fc" id="L440">        DataCollection testCollection = new DataCollection();</span>
<span class="fc" id="L441">        testCollection.setState(EnumState.NOTCOLLECTED);</span>
<span class="fc" id="L442">        testCollection.setIdStep(testStep);</span>
<span class="fc" id="L443">        testCollection.setIdUser(testUser);</span>
<span class="fc" id="L444">        testCollection.setPhoto(&quot;null&quot;);</span>
<span class="fc" id="L445">        testCollection.setText(&quot;null&quot;);</span>
<span class="fc" id="L446">        testCollection.setLongitude(&quot;null&quot;);</span>
<span class="fc" id="L447">        testCollection.setLatitude(&quot;null&quot;);</span>
<span class="fc" id="L448">        HibernateUtil.getSession().saveOrUpdate(testCollection);        </span>
<span class="fc" id="L449">	    HibernateUtil.commitTransaction();</span>
	    
<span class="fc" id="L451">	    User userObject = new User();</span>
<span class="fc" id="L452">	    userObject.setIdUser(testUser.getIdUser());</span>
	    
<span class="fc" id="L454">        HibernateUtil.getSession().beginTransaction();</span>
<span class="fc" id="L455">	    List&lt;Integer&gt; subscriptionIdList = daoManagementProcessUserObject.findAllClosedSubscription(userObject);</span>
<span class="fc" id="L456">	    HibernateUtil.commitTransaction();</span>
	    
<span class="fc" id="L458">	    assertEquals(subscriptionIdList.get(0), testSubscription.getIdSubscription());</span>
<span class="fc" id="L459">	}</span>
	
	/**
	 *	Test del metodo findDataCollection() che permette di trovare una data collection di un utente.
	 * @throws Exception segnala un problema di connessione al database
	 */
	@Test
	public void testFindDataCollection() throws Exception {
<span class="fc" id="L467">		DAOManagementProcessUser daoManagementProcessUserObject = new DAOManagementProcessUser();</span>
    	
    	//creazione ambiente per l'esecuzione della query
<span class="fc" id="L470">    	HibernateUtil.getSession().beginTransaction();</span>
    	
    	//creazione utente
<span class="fc" id="L473">        User testUser = new User();</span>
<span class="fc" id="L474">        testUser.setEmail(&quot;asd@asd.com&quot;);</span>
<span class="fc" id="L475">        testUser.setIsAdmin(false);</span>
<span class="fc" id="L476">        testUser.setPassword(&quot;test&quot;);</span>
<span class="fc" id="L477">        testUser.setUsername(&quot;testUser&quot;);</span>
<span class="fc" id="L478">        HibernateUtil.getSession().saveOrUpdate(testUser);</span>
        
        //creazione di un passo per il processo
<span class="fc" id="L481">        Step testStep = new Step();</span>
<span class="fc" id="L482">        testStep.setAdminVerify(false);</span>
<span class="fc" id="L483">        testStep.setDescription(&quot;test&quot;);</span>
<span class="fc" id="L484">        testStep.setCheckText(&quot;null&quot;);</span>
<span class="fc" id="L485">        testStep.setIsGeolocation(false);</span>
<span class="fc" id="L486">        testStep.setIsPhoto(false);</span>
<span class="fc" id="L487">        testStep.setIsText(false);</span>
<span class="fc" id="L488">        testStep.setLevel(1);</span>
<span class="fc" id="L489">        testStep.setParallelism(EnumParallelism.AND);</span>
<span class="fc" id="L490">        HibernateUtil.getSession().saveOrUpdate(testStep);</span>
        
        //iscrizione dell'utente al processo 
<span class="fc" id="L493">        Subscription testSubscription = new Subscription();</span>
<span class="fc" id="L494">        testSubscription.setComplete(false);</span>
<span class="fc" id="L495">        testSubscription.setIdUser(testUser);</span>
<span class="fc" id="L496">        HibernateUtil.getSession().saveOrUpdate(testSubscription);</span>
        
        //creazione di una data collection
<span class="fc" id="L499">        DataCollection testCollection = new DataCollection();</span>
<span class="fc" id="L500">        testCollection.setState(EnumState.TOVERIFY);</span>
<span class="fc" id="L501">        testCollection.setIdStep(testStep);</span>
<span class="fc" id="L502">        testCollection.setIdUser(testUser);</span>
<span class="fc" id="L503">        testCollection.setPhoto(&quot;null&quot;);</span>
<span class="fc" id="L504">        testCollection.setText(&quot;null&quot;);</span>
<span class="fc" id="L505">        testCollection.setLongitude(&quot;null&quot;);</span>
<span class="fc" id="L506">        testCollection.setLatitude(&quot;null&quot;);</span>
<span class="fc" id="L507">        HibernateUtil.getSession().saveOrUpdate(testCollection);        </span>
<span class="fc" id="L508">	    HibernateUtil.commitTransaction();</span>
	    
<span class="fc" id="L510">	    User userObject = new User();</span>
<span class="fc" id="L511">	    userObject.setIdUser(testUser.getIdUser());</span>
<span class="fc" id="L512">	    Step stepObject = new Step();</span>
<span class="fc" id="L513">	    stepObject.setIdStep(testStep.getIdStep());</span>
	    
<span class="fc" id="L515">	    HibernateUtil.getSession().beginTransaction();</span>
<span class="fc" id="L516">	    DataCollection dataCollectionObject = daoManagementProcessUserObject.findDataCollection(userObject, stepObject);</span>
<span class="fc" id="L517">	    HibernateUtil.commitTransaction();</span>
	    
<span class="fc" id="L519">	    assertEquals(dataCollectionObject.getIdStep().getDescription(), testCollection.getIdStep().getDescription());</span>
<span class="fc" id="L520">	}</span>
	
	/**
	 *	Test del metodo findDataCollectionByLevel() che permette di trovare la lista delle data collection (appartententi allo stesso livello) di un utente.
	 * @throws Exception segnala un problema di connessione al database
	 */
	@Test
	public void testFindDataCollectionByLevel() throws Exception {
<span class="fc" id="L528">		DAOManagementProcessUser daoManagementProcessUserObject = new DAOManagementProcessUser();</span>
    	
    	//creazione ambiente per l'esecuzione della query
<span class="fc" id="L531">    	HibernateUtil.getSession().beginTransaction();</span>
    	
    	//creazione utente
<span class="fc" id="L534">        User testUser = new User();</span>
<span class="fc" id="L535">        testUser.setEmail(&quot;asd@asd.com&quot;);</span>
<span class="fc" id="L536">        testUser.setIsAdmin(false);</span>
<span class="fc" id="L537">        testUser.setPassword(&quot;test&quot;);</span>
<span class="fc" id="L538">        testUser.setUsername(&quot;testUser&quot;);</span>
<span class="fc" id="L539">        HibernateUtil.getSession().saveOrUpdate(testUser);</span>
        
        //creazione di un passo per il processo
<span class="fc" id="L542">        Step testStep1 = new Step();</span>
<span class="fc" id="L543">        testStep1.setAdminVerify(false);</span>
<span class="fc" id="L544">        testStep1.setDescription(&quot;test&quot;);</span>
<span class="fc" id="L545">        testStep1.setCheckText(&quot;null&quot;);</span>
<span class="fc" id="L546">        testStep1.setIsGeolocation(false);</span>
<span class="fc" id="L547">        testStep1.setIsPhoto(false);</span>
<span class="fc" id="L548">        testStep1.setIsText(false);</span>
<span class="fc" id="L549">        testStep1.setLevel(1);</span>
<span class="fc" id="L550">        testStep1.setParallelism(EnumParallelism.OR);</span>
<span class="fc" id="L551">        HibernateUtil.getSession().saveOrUpdate(testStep1);</span>
        
        //creazione di un passo per il processo
<span class="fc" id="L554">        Step testStep2 = new Step();</span>
<span class="fc" id="L555">        testStep2.setAdminVerify(false);</span>
<span class="fc" id="L556">        testStep2.setDescription(&quot;test&quot;);</span>
<span class="fc" id="L557">        testStep2.setCheckText(&quot;null&quot;);</span>
<span class="fc" id="L558">        testStep2.setIsGeolocation(false);</span>
<span class="fc" id="L559">        testStep2.setIsPhoto(false);</span>
<span class="fc" id="L560">        testStep2.setIsText(false);</span>
<span class="fc" id="L561">        testStep2.setLevel(1);</span>
<span class="fc" id="L562">        testStep2.setParallelism(EnumParallelism.OR);</span>
<span class="fc" id="L563">        HibernateUtil.getSession().saveOrUpdate(testStep2);</span>
        
        //creazione di una data collection
<span class="fc" id="L566">        DataCollection testCollection1 = new DataCollection();</span>
<span class="fc" id="L567">        testCollection1.setState(EnumState.TOVERIFY);</span>
<span class="fc" id="L568">        testCollection1.setIdStep(testStep1);</span>
<span class="fc" id="L569">        testCollection1.setIdUser(testUser);</span>
<span class="fc" id="L570">        testCollection1.setPhoto(&quot;null&quot;);</span>
<span class="fc" id="L571">        testCollection1.setText(&quot;null&quot;);</span>
<span class="fc" id="L572">        testCollection1.setLongitude(&quot;null&quot;);</span>
<span class="fc" id="L573">        testCollection1.setLatitude(&quot;null&quot;);</span>
<span class="fc" id="L574">        HibernateUtil.getSession().saveOrUpdate(testCollection1);</span>
        
        //creazione di una data collection
<span class="fc" id="L577">        DataCollection testCollection2 = new DataCollection();</span>
<span class="fc" id="L578">        testCollection2.setState(EnumState.TOVERIFY);</span>
<span class="fc" id="L579">        testCollection2.setIdStep(testStep2);</span>
<span class="fc" id="L580">        testCollection2.setIdUser(testUser);</span>
<span class="fc" id="L581">        testCollection2.setPhoto(&quot;null&quot;);</span>
<span class="fc" id="L582">        testCollection2.setText(&quot;null&quot;);</span>
<span class="fc" id="L583">        testCollection2.setLongitude(&quot;null&quot;);</span>
<span class="fc" id="L584">        testCollection2.setLatitude(&quot;null&quot;);</span>
<span class="fc" id="L585">        HibernateUtil.getSession().saveOrUpdate(testCollection2); </span>
<span class="fc" id="L586">	    HibernateUtil.commitTransaction();</span>
	    	    
<span class="fc" id="L588">	    HibernateUtil.getSession().beginTransaction();</span>
<span class="fc" id="L589">	    List&lt;DataCollection&gt; dataCollectionList = daoManagementProcessUserObject.findDataCollectionByLevel(testCollection1);</span>
<span class="fc" id="L590">	    HibernateUtil.commitTransaction();</span>
	    
<span class="fc" id="L592">	    assertEquals(dataCollectionList.get(0).getIdCollection(), testCollection2.getIdCollection());</span>
<span class="fc" id="L593">	    assertEquals(dataCollectionList.get(0).getIdUser().getName(), testCollection1.getIdUser().getName());</span>
<span class="fc" id="L594">	}</span>
	
	/**
	 *	Test del metodo findMinStep() che ritorna il livello minimo del passo a cui l'utente è arrivato.
	 * @throws Exception segnala un problema di connessione al database
	 */
	@Test
	public void testFindMinStep() throws Exception {
<span class="fc" id="L602">		DAOManagementProcessUser daoManagementProcessUserObject = new DAOManagementProcessUser();</span>
    	
    	//creazione ambiente per l'esecuzione della query
<span class="fc" id="L605">    	HibernateUtil.getSession().beginTransaction();</span>
    	
    	//creazione amministratore
<span class="fc" id="L608">        User testAdmin = new User();</span>
<span class="fc" id="L609">        testAdmin.setEmail(&quot;asd@asd.com&quot;);</span>
<span class="fc" id="L610">        testAdmin.setIsAdmin(true);</span>
<span class="fc" id="L611">        testAdmin.setPassword(&quot;test&quot;);</span>
<span class="fc" id="L612">        testAdmin.setUsername(&quot;testAdmin&quot;);</span>
<span class="fc" id="L613">        HibernateUtil.getSession().saveOrUpdate(testAdmin);</span>
    	
    	//creazione utente
<span class="fc" id="L616">        User testUser = new User();</span>
<span class="fc" id="L617">        testUser.setEmail(&quot;asd@asd.com&quot;);</span>
<span class="fc" id="L618">        testUser.setIsAdmin(false);</span>
<span class="fc" id="L619">        testUser.setPassword(&quot;test&quot;);</span>
<span class="fc" id="L620">        testUser.setUsername(&quot;testUser&quot;);</span>
<span class="fc" id="L621">        HibernateUtil.getSession().saveOrUpdate(testUser);</span>
        
        //creazione processo
<span class="fc" id="L624">        Process testProcess = new Process();</span>
<span class="fc" id="L625">        testProcess.setAdmin(testAdmin);</span>
<span class="fc" id="L626">        testProcess.setAvailable(true);</span>
<span class="fc" id="L627">        testProcess.setDescription(&quot;Processo di test&quot;);</span>
<span class="fc" id="L628">        testProcess.setEndSubscriptionDate(new GregorianCalendar(2020,12,31,23,59,59));</span>
<span class="fc" id="L629">        testProcess.setClosingDate(new GregorianCalendar(2020,12,31,23,59,59));</span>
<span class="fc" id="L630">        testProcess.setName(&quot;test&quot;);</span>
<span class="fc" id="L631">        testProcess.setPublicationDate(new GregorianCalendar(2012,12,31,23,59,59));</span>
<span class="fc" id="L632">        testProcess.setTotalLevel(1);</span>
<span class="fc" id="L633">        HibernateUtil.getSession().saveOrUpdate(testProcess);</span>
        
        //creazione di un passo per il processo
<span class="fc" id="L636">        Step testStep = new Step();</span>
<span class="fc" id="L637">        testStep.setAdminVerify(false);</span>
<span class="fc" id="L638">        testStep.setDescription(&quot;test&quot;);</span>
<span class="fc" id="L639">        testStep.setCheckText(&quot;null&quot;);</span>
<span class="fc" id="L640">        testStep.setIsGeolocation(false);</span>
<span class="fc" id="L641">        testStep.setIsPhoto(false);</span>
<span class="fc" id="L642">        testStep.setIsText(false);</span>
<span class="fc" id="L643">        testStep.setLevel(1);</span>
<span class="fc" id="L644">        testStep.setParallelism(EnumParallelism.AND);</span>
<span class="fc" id="L645">        testStep.setIdProcess(testProcess);</span>
<span class="fc" id="L646">        HibernateUtil.getSession().saveOrUpdate(testStep);</span>
        
        //inserimento del passo nel processo
<span class="fc" id="L649">        List&lt;Step&gt; testStepList = new ArrayList&lt;Step&gt;();</span>
<span class="fc" id="L650">        testStepList.add(testStep);</span>
<span class="fc" id="L651">        testProcess.setSteps(testStepList);</span>
<span class="fc" id="L652">        HibernateUtil.getSession().saveOrUpdate(testProcess);</span>
        
        //iscrizione dell'utente al processo 
<span class="fc" id="L655">        Subscription testSubscription = new Subscription();</span>
<span class="fc" id="L656">        testSubscription.setComplete(false);</span>
<span class="fc" id="L657">        testSubscription.setIdUser(testUser);</span>
<span class="fc" id="L658">        testSubscription.setIdProcess(testProcess);</span>
<span class="fc" id="L659">        HibernateUtil.getSession().saveOrUpdate(testSubscription);</span>
        
        //creazione di una data collection
<span class="fc" id="L662">        DataCollection testCollection = new DataCollection();</span>
<span class="fc" id="L663">        testCollection.setState(EnumState.TOVERIFY);</span>
<span class="fc" id="L664">        testCollection.setIdStep(testStep);</span>
<span class="fc" id="L665">        testCollection.setIdUser(testUser);</span>
<span class="fc" id="L666">        testCollection.setPhoto(&quot;null&quot;);</span>
<span class="fc" id="L667">        testCollection.setText(&quot;null&quot;);</span>
<span class="fc" id="L668">        testCollection.setLongitude(&quot;null&quot;);</span>
<span class="fc" id="L669">        testCollection.setLatitude(&quot;null&quot;);</span>
<span class="fc" id="L670">        HibernateUtil.getSession().saveOrUpdate(testCollection);        </span>
<span class="fc" id="L671">	    HibernateUtil.commitTransaction();</span>
	    
<span class="fc" id="L673">        HibernateUtil.getSession().beginTransaction();</span>
<span class="fc" id="L674">	    Integer minLevel = daoManagementProcessUserObject.findMinStep(testUser, testProcess);</span>
<span class="fc" id="L675">	    HibernateUtil.commitTransaction();</span>
	    
<span class="fc" id="L677">	    assertEquals(minLevel, testStep.getLevel());</span>
    	
<span class="fc" id="L679">	}</span>
	
	/**
	 *	Test del metodo findProcessById() che permette di trovare un processo a partire dal suo id.
	 * @throws Exception segnala un problema di connessione al database
	 */
	@Test
	public void testFindProcessById() throws Exception {
<span class="fc" id="L687">		DAOManagementProcessUser daoManagementProcessUserObject = new DAOManagementProcessUser();</span>
        
        //creazione ambiente per l'esecuzione della query
<span class="fc" id="L690">        HibernateUtil.getSession().beginTransaction();</span>
        
        //creazione processo
<span class="fc" id="L693">        Process testProcess = new Process();</span>
<span class="fc" id="L694">        testProcess.setAvailable(true);</span>
<span class="fc" id="L695">        testProcess.setDescription(&quot;Processo di test&quot;);</span>
<span class="fc" id="L696">        testProcess.setEndSubscriptionDate(new GregorianCalendar(2020,12,31,23,59,59));</span>
<span class="fc" id="L697">        testProcess.setClosingDate(new GregorianCalendar(2020,12,31,23,59,59));</span>
<span class="fc" id="L698">        testProcess.setName(&quot;test&quot;);</span>
<span class="fc" id="L699">        testProcess.setPublicationDate(new GregorianCalendar(2012,12,31,23,59,59));</span>
<span class="fc" id="L700">        testProcess.setTotalLevel(1);</span>
<span class="fc" id="L701">        HibernateUtil.getSession().saveOrUpdate(testProcess);</span>
<span class="fc" id="L702">	    HibernateUtil.commitTransaction();</span>
	    
<span class="fc" id="L704">	    Process processObject = new Process();</span>
<span class="fc" id="L705">	    processObject.setIdProcess(testProcess.getIdProcess());</span>
	    
<span class="fc" id="L707">        HibernateUtil.getSession().beginTransaction();</span>
<span class="fc" id="L708">        Process processReturnedObject = daoManagementProcessUserObject.findProcessById(processObject);</span>
<span class="fc" id="L709">	    HibernateUtil.commitTransaction();</span>

<span class="fc" id="L711">	    assertEquals(testProcess.getDescription(), processReturnedObject.getDescription());</span>
<span class="fc" id="L712">	}</span>
	
	/**
	 *	Test del metodo findSubscription() che permette di trovare l'iscrizione di un utente ad un processo.
	 * @throws Exception segnala un problema di connessione al database
	 */
	@Test
	public void testFindSubscription() throws Exception {
<span class="fc" id="L720">		DAOManagementProcessUser daoManagementProcessUserObject = new DAOManagementProcessUser();</span>
        
        //creazione ambiente per l'esecuzione della query
<span class="fc" id="L723">        HibernateUtil.getSession().beginTransaction();</span>
        
        //creazione utente
<span class="fc" id="L726">        User testUser = new User();</span>
<span class="fc" id="L727">        testUser.setEmail(&quot;asd@asd.com&quot;);</span>
<span class="fc" id="L728">        testUser.setIsAdmin(false);</span>
<span class="fc" id="L729">        testUser.setPassword(&quot;test&quot;);</span>
<span class="fc" id="L730">        testUser.setUsername(&quot;test&quot;);</span>
<span class="fc" id="L731">        HibernateUtil.getSession().saveOrUpdate(testUser);</span>
        
        //creazione processo
<span class="fc" id="L734">        Process testProcess = new Process();</span>
<span class="fc" id="L735">        testProcess.setAvailable(true);</span>
<span class="fc" id="L736">        testProcess.setDescription(&quot;Processo di test&quot;);</span>
<span class="fc" id="L737">        testProcess.setEndSubscriptionDate(new GregorianCalendar(2020,12,31,23,59,59));</span>
<span class="fc" id="L738">        testProcess.setClosingDate(new GregorianCalendar(2020,12,31,23,59,59));</span>
<span class="fc" id="L739">        testProcess.setName(&quot;test&quot;);</span>
<span class="fc" id="L740">        testProcess.setPublicationDate(new GregorianCalendar(2012,12,31,23,59,59));</span>
<span class="fc" id="L741">        testProcess.setTotalLevel(1);</span>
<span class="fc" id="L742">        HibernateUtil.getSession().saveOrUpdate(testProcess);</span>
        
        //creazione di un passo per il processo
<span class="fc" id="L745">        Step testStep = new Step();</span>
<span class="fc" id="L746">        testStep.setAdminVerify(false);</span>
<span class="fc" id="L747">        testStep.setDescription(&quot;test&quot;);</span>
<span class="fc" id="L748">        testStep.setIsGeolocation(false);</span>
<span class="fc" id="L749">        testStep.setIsPhoto(false);</span>
<span class="fc" id="L750">        testStep.setIsText(false);</span>
<span class="fc" id="L751">        testStep.setLevel(1);</span>
<span class="fc" id="L752">        testStep.setParallelism(EnumParallelism.AND);</span>
<span class="fc" id="L753">        testStep.setIdProcess(testProcess);</span>
<span class="fc" id="L754">        HibernateUtil.getSession().saveOrUpdate(testStep);</span>
        
        //inserimento del passo nel processo
<span class="fc" id="L757">        List&lt;Step&gt; testStepList = new ArrayList&lt;Step&gt;();</span>
<span class="fc" id="L758">        testStepList.add(testStep);</span>
<span class="fc" id="L759">        testProcess.setSteps(testStepList);</span>
<span class="fc" id="L760">        HibernateUtil.getSession().saveOrUpdate(testProcess);</span>
        
        //iscrizione dell'utente al processo 
<span class="fc" id="L763">        Subscription testSubscription = new Subscription();</span>
<span class="fc" id="L764">        testSubscription.setComplete(false);</span>
<span class="fc" id="L765">        testSubscription.setIdUser(testUser);</span>
<span class="fc" id="L766">        testSubscription.setIdProcess(testProcess);</span>
<span class="fc" id="L767">        HibernateUtil.getSession().saveOrUpdate(testSubscription);</span>
<span class="fc" id="L768">	    HibernateUtil.commitTransaction();</span>
	    
<span class="fc" id="L770">	    User userObject = new User();</span>
<span class="fc" id="L771">	    userObject.setIdUser(testUser.getIdUser());</span>

<span class="fc" id="L773">	    Process processObject = new Process();</span>
<span class="fc" id="L774">	    processObject.setIdProcess(testProcess.getIdProcess());</span>
	    
<span class="fc" id="L776">        HibernateUtil.getSession().beginTransaction();</span>
<span class="fc" id="L777">        Subscription subscriptionObject = daoManagementProcessUserObject.findSubscription(userObject, processObject);</span>
<span class="fc" id="L778">	    HibernateUtil.commitTransaction();</span>
	
<span class="fc" id="L780">	    assertEquals(testSubscription.getIdUser().getIdUser(), subscriptionObject.getIdUser().getIdUser());</span>
<span class="fc" id="L781">	}</span>
	
	/**
	 *	Test del metodo insertSubscription() che permette ad un utente di iscriversi ad un nuovo processo.
	 * @throws Exception segnala un problema di connessione al database
	 */
	@Test
    public void testInsertSubscription() throws Exception {
<span class="fc" id="L789">    	DAOManagementProcessUser daoManagementProcessUserObject = new DAOManagementProcessUser();</span>
        
        //creazione ambiente per l'esecuzione della query
<span class="fc" id="L792">        HibernateUtil.getSession().beginTransaction();</span>
        
        //creazione utente
<span class="fc" id="L795">        User testUser = new User();</span>
<span class="fc" id="L796">        testUser.setEmail(&quot;asd@asd.com&quot;);</span>
<span class="fc" id="L797">        testUser.setIsAdmin(false);</span>
<span class="fc" id="L798">        testUser.setPassword(&quot;test&quot;);</span>
<span class="fc" id="L799">        testUser.setUsername(&quot;test&quot;);</span>
<span class="fc" id="L800">        HibernateUtil.getSession().saveOrUpdate(testUser);</span>
        
        //creazione processo
<span class="fc" id="L803">        Process testProcess = new Process();</span>
<span class="fc" id="L804">        testProcess.setAvailable(true);</span>
<span class="fc" id="L805">        testProcess.setDescription(&quot;Processo di test&quot;);</span>
<span class="fc" id="L806">        testProcess.setEndSubscriptionDate(new GregorianCalendar(2020,12,31,23,59,59));</span>
<span class="fc" id="L807">        testProcess.setClosingDate(new GregorianCalendar(2020,12,31,23,59,59));</span>
<span class="fc" id="L808">        testProcess.setName(&quot;test&quot;);</span>
<span class="fc" id="L809">        testProcess.setPublicationDate(new GregorianCalendar(2012,12,31,23,59,59));</span>
<span class="fc" id="L810">        testProcess.setTotalLevel(1);</span>
<span class="fc" id="L811">        HibernateUtil.getSession().saveOrUpdate(testProcess);</span>
        
        //creazione di un passo per il processo
<span class="fc" id="L814">        Step testStep = new Step();</span>
<span class="fc" id="L815">        testStep.setAdminVerify(false);</span>
<span class="fc" id="L816">        testStep.setDescription(&quot;test&quot;);</span>
<span class="fc" id="L817">        testStep.setIsGeolocation(false);</span>
<span class="fc" id="L818">        testStep.setIsPhoto(false);</span>
<span class="fc" id="L819">        testStep.setIsText(false);</span>
<span class="fc" id="L820">        testStep.setLevel(1);</span>
<span class="fc" id="L821">        testStep.setParallelism(EnumParallelism.AND);</span>
<span class="fc" id="L822">        testStep.setIdProcess(testProcess);</span>
<span class="fc" id="L823">        HibernateUtil.getSession().saveOrUpdate(testStep);</span>
        
        //inserimento del passo nel processo
<span class="fc" id="L826">        List&lt;Step&gt; testStepList = new ArrayList&lt;Step&gt;();</span>
<span class="fc" id="L827">        testStepList.add(testStep);</span>
<span class="fc" id="L828">        testProcess.setSteps(testStepList);</span>
<span class="fc" id="L829">        HibernateUtil.getSession().saveOrUpdate(testProcess);</span>
<span class="fc" id="L830">	    HibernateUtil.commitTransaction();</span>
        
        //creazione dell'oggetto Subscription
<span class="fc" id="L833">        Subscription newSubscriprtion = new Subscription();</span>
<span class="fc" id="L834">        newSubscriprtion.setIdUser(testUser);</span>
<span class="fc" id="L835">        newSubscriprtion.setIdProcess(testProcess);</span>
<span class="fc" id="L836">        newSubscriprtion.setComplete(false);</span>
        
<span class="fc" id="L838">        HibernateUtil.getSession().beginTransaction();</span>
<span class="fc" id="L839">        daoManagementProcessUserObject.insertSubscription(newSubscriprtion);</span>
<span class="fc" id="L840">	    HibernateUtil.commitTransaction();</span>
	    
<span class="fc" id="L842">	    assertFalse(newSubscriprtion.getComplete());</span>
<span class="fc" id="L843">    }</span>
    
	/**
	 *	Test del metodo findAvailableProcess() che permette di trovare tutti i processi a cui l'utente non è ancora iscritto.
	 * @throws Exception segnala un problema di connessione al database
	 */
	@Test
    public void testFindAvailableProcess() throws Exception {
<span class="fc" id="L851">        DAOManagementProcessUser daoManagementProcessUserObject = new DAOManagementProcessUser();</span>
        
        //creazione ambiente per l'esecuzione della query
<span class="fc" id="L854">        HibernateUtil.getSession().beginTransaction();</span>
        
        //creazione utente
<span class="fc" id="L857">        User testUser = new User();</span>
<span class="fc" id="L858">        testUser.setEmail(&quot;asd@asd.com&quot;);</span>
<span class="fc" id="L859">        testUser.setIsAdmin(false);</span>
<span class="fc" id="L860">        testUser.setPassword(&quot;test&quot;);</span>
<span class="fc" id="L861">        testUser.setUsername(&quot;test&quot;);</span>
<span class="fc" id="L862">        HibernateUtil.getSession().saveOrUpdate(testUser);</span>
        
        //creazione processo
<span class="fc" id="L865">        Process testProcess = new Process();</span>
<span class="fc" id="L866">        testProcess.setAvailable(true);</span>
<span class="fc" id="L867">        testProcess.setDescription(&quot;Processo di test&quot;);</span>
<span class="fc" id="L868">        testProcess.setEndSubscriptionDate(new GregorianCalendar(2020,12,31,23,59,59));</span>
<span class="fc" id="L869">        testProcess.setClosingDate(new GregorianCalendar(2020,12,31,23,59,59));</span>
<span class="fc" id="L870">        testProcess.setName(&quot;test&quot;);</span>
<span class="fc" id="L871">        testProcess.setPublicationDate(new GregorianCalendar(2012,12,31,23,59,59));</span>
<span class="fc" id="L872">        testProcess.setTotalLevel(1);</span>
<span class="fc" id="L873">        HibernateUtil.getSession().saveOrUpdate(testProcess);</span>
        
        //creazione di un passo per il processo
<span class="fc" id="L876">        Step testStep = new Step();</span>
<span class="fc" id="L877">        testStep.setAdminVerify(false);</span>
<span class="fc" id="L878">        testStep.setDescription(&quot;test&quot;);</span>
<span class="fc" id="L879">        testStep.setIsGeolocation(false);</span>
<span class="fc" id="L880">        testStep.setIsPhoto(false);</span>
<span class="fc" id="L881">        testStep.setIsText(false);</span>
<span class="fc" id="L882">        testStep.setLevel(1);</span>
<span class="fc" id="L883">        testStep.setParallelism(EnumParallelism.AND);</span>
<span class="fc" id="L884">        testStep.setIdProcess(testProcess);</span>
<span class="fc" id="L885">        HibernateUtil.getSession().saveOrUpdate(testStep);</span>
        
        //inserimento del passo nel processo
<span class="fc" id="L888">        List&lt;Step&gt; testStepList1 = new ArrayList&lt;Step&gt;();</span>
<span class="fc" id="L889">        testStepList1.add(testStep);</span>
<span class="fc" id="L890">        testProcess.setSteps(testStepList1);</span>
<span class="fc" id="L891">        HibernateUtil.getSession().saveOrUpdate(testProcess);        </span>
<span class="fc" id="L892">        HibernateUtil.commitTransaction();</span>
	    
<span class="fc" id="L894">        HibernateUtil.getSession().beginTransaction();</span>
<span class="fc" id="L895">        List&lt;Process&gt; processList = daoManagementProcessUserObject.findAvailableProcess(testUser);</span>
<span class="fc" id="L896">	    HibernateUtil.commitTransaction();</span>
	    
<span class="fc" id="L898">	    assertEquals(1, processList.size());</span>
<span class="fc" id="L899">    }</span>
    
    /**
	 *	Test del metodo findActiveProcess() che permette di trovare tutti i processi a cui l'utente è iscritto.
     * @throws Exception segnala un problema di connessione al database
	 */
	@Test
    public void testFindActiveProcess() throws Exception {
<span class="fc" id="L907">        DAOManagementProcessUser daoManagementProcessUserObject = new DAOManagementProcessUser();</span>
        
        //creazione ambiente per l'esecuzione della query
<span class="fc" id="L910">        HibernateUtil.getSession().beginTransaction();</span>
        
        //creazione utente
<span class="fc" id="L913">        User testUser = new User();</span>
<span class="fc" id="L914">        testUser.setEmail(&quot;asd@asd.com&quot;);</span>
<span class="fc" id="L915">        testUser.setIsAdmin(false);</span>
<span class="fc" id="L916">        testUser.setPassword(&quot;test&quot;);</span>
<span class="fc" id="L917">        testUser.setUsername(&quot;test&quot;);</span>
<span class="fc" id="L918">        HibernateUtil.getSession().saveOrUpdate(testUser);</span>
        
        //creazione processo
<span class="fc" id="L921">        Process testProcess = new Process();</span>
<span class="fc" id="L922">        testProcess.setAvailable(true);</span>
<span class="fc" id="L923">        testProcess.setDescription(&quot;Processo di test&quot;);</span>
<span class="fc" id="L924">        testProcess.setEndSubscriptionDate(new GregorianCalendar(2020,12,31,23,59,59));</span>
<span class="fc" id="L925">        testProcess.setClosingDate(new GregorianCalendar(2020,12,31,23,59,59));</span>
<span class="fc" id="L926">        testProcess.setName(&quot;test&quot;);</span>
<span class="fc" id="L927">        testProcess.setPublicationDate(new GregorianCalendar(2012,12,31,23,59,59));</span>
<span class="fc" id="L928">        testProcess.setTotalLevel(1);</span>
<span class="fc" id="L929">        HibernateUtil.getSession().saveOrUpdate(testProcess);</span>
        
        //creazione di un passo per il processo
<span class="fc" id="L932">        Step testStep = new Step();</span>
<span class="fc" id="L933">        testStep.setAdminVerify(false);</span>
<span class="fc" id="L934">        testStep.setDescription(&quot;test&quot;);</span>
<span class="fc" id="L935">        testStep.setIsGeolocation(false);</span>
<span class="fc" id="L936">        testStep.setIsPhoto(false);</span>
<span class="fc" id="L937">        testStep.setIsText(false);</span>
<span class="fc" id="L938">        testStep.setLevel(1);</span>
<span class="fc" id="L939">        testStep.setParallelism(EnumParallelism.AND);</span>
<span class="fc" id="L940">        testStep.setIdProcess(testProcess);</span>
<span class="fc" id="L941">        HibernateUtil.getSession().saveOrUpdate(testStep);</span>
        
        //inserimento del passo nel processo
<span class="fc" id="L944">        List&lt;Step&gt; testStepList = new ArrayList&lt;Step&gt;();</span>
<span class="fc" id="L945">        testStepList.add(testStep);</span>
<span class="fc" id="L946">        testProcess.setSteps(testStepList);</span>
<span class="fc" id="L947">        HibernateUtil.getSession().saveOrUpdate(testProcess);</span>
        
        //iscrizione dell'utente al processo 
<span class="fc" id="L950">        Subscription testSubscription = new Subscription();</span>
<span class="fc" id="L951">        testSubscription.setComplete(false);</span>
<span class="fc" id="L952">        testSubscription.setIdUser(testUser);</span>
<span class="fc" id="L953">        testSubscription.setIdProcess(testProcess);</span>
<span class="fc" id="L954">        HibernateUtil.getSession().saveOrUpdate(testSubscription);</span>
<span class="fc" id="L955">	    HibernateUtil.commitTransaction();</span>
	    
<span class="fc" id="L957">        HibernateUtil.getSession().beginTransaction();</span>
<span class="fc" id="L958">        List&lt;Subscription&gt; subscriptionList = daoManagementProcessUserObject.findActiveProcess(testUser);</span>
<span class="fc" id="L959">	    HibernateUtil.commitTransaction();</span>
	    
<span class="fc" id="L961">	    assertEquals(1, subscriptionList.size());</span>
<span class="fc" id="L962">    }</span>
	
    /**
	 *	Test del metodo findStep() che permette di recuperare le data collection da completare e i dati dei corrispondenti passi.
	 *	Vengono testati entrambi i metodi: findStep(User, Process, Integer) e findStep(Step).
     * @throws Exception segnala un problema di connessione al database
	 */
	@Test
    public void testFindStep() throws Exception {
<span class="fc" id="L971">    	DAOManagementProcessUser daoManagementProcessUserObject = new DAOManagementProcessUser();</span>
    	
    	//creazione ambiente per l'esecuzione della query
<span class="fc" id="L974">    	HibernateUtil.getSession().beginTransaction();</span>
    	
    	//creazione amministratore
<span class="fc" id="L977">        User testAdmin = new User();</span>
<span class="fc" id="L978">        testAdmin.setEmail(&quot;asd@asd.com&quot;);</span>
<span class="fc" id="L979">        testAdmin.setIsAdmin(true);</span>
<span class="fc" id="L980">        testAdmin.setPassword(&quot;test&quot;);</span>
<span class="fc" id="L981">        testAdmin.setUsername(&quot;testAdmin&quot;);</span>
<span class="fc" id="L982">        HibernateUtil.getSession().saveOrUpdate(testAdmin);</span>
    	
    	//creazione utente
<span class="fc" id="L985">        User testUser = new User();</span>
<span class="fc" id="L986">        testUser.setEmail(&quot;asd@asd.com&quot;);</span>
<span class="fc" id="L987">        testUser.setIsAdmin(false);</span>
<span class="fc" id="L988">        testUser.setPassword(&quot;test&quot;);</span>
<span class="fc" id="L989">        testUser.setUsername(&quot;testUser&quot;);</span>
<span class="fc" id="L990">        HibernateUtil.getSession().saveOrUpdate(testUser);</span>
        
        //creazione processo
<span class="fc" id="L993">        Process testProcess = new Process();</span>
<span class="fc" id="L994">        testProcess.setAdmin(testAdmin);</span>
<span class="fc" id="L995">        testProcess.setAvailable(true);</span>
<span class="fc" id="L996">        testProcess.setDescription(&quot;Processo di test&quot;);</span>
<span class="fc" id="L997">        testProcess.setEndSubscriptionDate(new GregorianCalendar(2020,12,31,23,59,59));</span>
<span class="fc" id="L998">        testProcess.setClosingDate(new GregorianCalendar(2020,12,31,23,59,59));</span>
<span class="fc" id="L999">        testProcess.setName(&quot;test&quot;);</span>
<span class="fc" id="L1000">        testProcess.setPublicationDate(new GregorianCalendar(2012,12,31,23,59,59));</span>
<span class="fc" id="L1001">        testProcess.setTotalLevel(1);</span>
<span class="fc" id="L1002">        HibernateUtil.getSession().saveOrUpdate(testProcess);</span>
        
        //creazione di un passo per il processo
<span class="fc" id="L1005">        Step testStep = new Step();</span>
<span class="fc" id="L1006">        testStep.setAdminVerify(false);</span>
<span class="fc" id="L1007">        testStep.setDescription(&quot;test&quot;);</span>
<span class="fc" id="L1008">        testStep.setCheckText(&quot;null&quot;);</span>
<span class="fc" id="L1009">        testStep.setIsGeolocation(false);</span>
<span class="fc" id="L1010">        testStep.setIsPhoto(false);</span>
<span class="fc" id="L1011">        testStep.setIsText(false);</span>
<span class="fc" id="L1012">        testStep.setLevel(1);</span>
<span class="fc" id="L1013">        testStep.setParallelism(EnumParallelism.AND);</span>
<span class="fc" id="L1014">        testStep.setIdProcess(testProcess);</span>
<span class="fc" id="L1015">        HibernateUtil.getSession().saveOrUpdate(testStep);</span>
        
        //inserimento del passo nel processo
<span class="fc" id="L1018">        List&lt;Step&gt; testStepList = new ArrayList&lt;Step&gt;();</span>
<span class="fc" id="L1019">        testStepList.add(testStep);</span>
<span class="fc" id="L1020">        testProcess.setSteps(testStepList);</span>
<span class="fc" id="L1021">        HibernateUtil.getSession().saveOrUpdate(testProcess);</span>
        
        //iscrizione dell'utente al processo 
<span class="fc" id="L1024">        Subscription testSubscription = new Subscription();</span>
<span class="fc" id="L1025">        testSubscription.setComplete(false);</span>
<span class="fc" id="L1026">        testSubscription.setIdUser(testUser);</span>
<span class="fc" id="L1027">        testSubscription.setIdProcess(testProcess);</span>
<span class="fc" id="L1028">        HibernateUtil.getSession().saveOrUpdate(testSubscription);</span>
        
        //creazione di una data collection
<span class="fc" id="L1031">        DataCollection testCollection = new DataCollection();</span>
<span class="fc" id="L1032">        testCollection.setState(EnumState.TOVERIFY);</span>
<span class="fc" id="L1033">        testCollection.setIdStep(testStep);</span>
<span class="fc" id="L1034">        testCollection.setIdUser(testUser);</span>
<span class="fc" id="L1035">        testCollection.setPhoto(&quot;null&quot;);</span>
<span class="fc" id="L1036">        testCollection.setText(&quot;null&quot;);</span>
<span class="fc" id="L1037">        testCollection.setLongitude(&quot;null&quot;);</span>
<span class="fc" id="L1038">        testCollection.setLatitude(&quot;null&quot;);</span>
<span class="fc" id="L1039">        HibernateUtil.getSession().saveOrUpdate(testCollection);        </span>
<span class="fc" id="L1040">	    HibernateUtil.commitTransaction();</span>
	    
<span class="fc" id="L1042">        HibernateUtil.getSession().beginTransaction();</span>
<span class="fc" id="L1043">	    Integer minLevel = daoManagementProcessUserObject.findMinStep(testUser, testProcess);</span>
<span class="fc" id="L1044">	    HibernateUtil.commitTransaction();</span>
        
	    //test metodo: public List&lt;DataCollection&gt; findStep(User user, Process process, Integer minLevel)
<span class="fc" id="L1047">	    HibernateUtil.getSession().beginTransaction();</span>
<span class="fc" id="L1048">	    List&lt;DataCollection&gt; dataCollectionList = daoManagementProcessUserObject.findStep(testUser, testProcess, minLevel);</span>
<span class="fc" id="L1049">	    HibernateUtil.commitTransaction();</span>
	    
<span class="fc" id="L1051">	    assertEquals(1, dataCollectionList.size());</span>
<span class="fc" id="L1052">	    assertEquals(testStep.getIdStep(), dataCollectionList.get(0).getIdStep().getIdStep());</span>
	    
	    //test metodo: public Step findStep(Step step)
<span class="fc" id="L1055">	    HibernateUtil.getSession().beginTransaction();</span>
<span class="fc" id="L1056">	    Step returnedStep = daoManagementProcessUserObject.findStep(testStep);</span>
<span class="fc" id="L1057">	    HibernateUtil.commitTransaction();</span>
	    
<span class="fc" id="L1059">	    assertEquals(testStep.getIdStep(), returnedStep.getIdStep());</span>
<span class="fc" id="L1060">    }</span>
    
    /**
	 *	Test del metodo insertDataCollection() che permette di completare un passo caricando una raccolta dati.
     * @throws Exception segnala un problema di connessione al database
	 */
	@Test
    public void testInsertDataCollection() throws Exception {
<span class="fc" id="L1068">    	DAOManagementProcessUser daoManagementProcessUserObject = new DAOManagementProcessUser();</span>
    	
    	//creazione ambiente per l'esecuzione della query
<span class="fc" id="L1071">    	HibernateUtil.getSession().beginTransaction();</span>
    	
    	//creazione amministratore
<span class="fc" id="L1074">        User testAdmin = new User();</span>
<span class="fc" id="L1075">        testAdmin.setEmail(&quot;asd@asd.com&quot;);</span>
<span class="fc" id="L1076">        testAdmin.setIsAdmin(true);</span>
<span class="fc" id="L1077">        testAdmin.setPassword(&quot;test&quot;);</span>
<span class="fc" id="L1078">        testAdmin.setUsername(&quot;testAdmin&quot;);</span>
<span class="fc" id="L1079">        HibernateUtil.getSession().saveOrUpdate(testAdmin);</span>
    	
    	//creazione utente
<span class="fc" id="L1082">        User testUser = new User();</span>
<span class="fc" id="L1083">        testUser.setEmail(&quot;asd@asd.com&quot;);</span>
<span class="fc" id="L1084">        testUser.setIsAdmin(false);</span>
<span class="fc" id="L1085">        testUser.setPassword(&quot;test&quot;);</span>
<span class="fc" id="L1086">        testUser.setUsername(&quot;testUser&quot;);</span>
<span class="fc" id="L1087">        HibernateUtil.getSession().saveOrUpdate(testUser);</span>
        
        //creazione processo
<span class="fc" id="L1090">        Process testProcess = new Process();</span>
<span class="fc" id="L1091">        testProcess.setAdmin(testAdmin);</span>
<span class="fc" id="L1092">        testProcess.setAvailable(true);</span>
<span class="fc" id="L1093">        testProcess.setDescription(&quot;Processo di test&quot;);</span>
<span class="fc" id="L1094">        testProcess.setEndSubscriptionDate(new GregorianCalendar(2020,12,31,23,59,59));</span>
<span class="fc" id="L1095">        testProcess.setClosingDate(new GregorianCalendar(2020,12,31,23,59,59));</span>
<span class="fc" id="L1096">        testProcess.setName(&quot;test&quot;);</span>
<span class="fc" id="L1097">        testProcess.setPublicationDate(new GregorianCalendar(2012,12,31,23,59,59));</span>
<span class="fc" id="L1098">        testProcess.setTotalLevel(1);</span>
<span class="fc" id="L1099">        HibernateUtil.getSession().saveOrUpdate(testProcess);</span>
        
        //creazione di un passo per il processo
<span class="fc" id="L1102">        Step testStep = new Step();</span>
<span class="fc" id="L1103">        testStep.setAdminVerify(false);</span>
<span class="fc" id="L1104">        testStep.setDescription(&quot;test&quot;);</span>
<span class="fc" id="L1105">        testStep.setCheckText(&quot;null&quot;);</span>
<span class="fc" id="L1106">        testStep.setIsGeolocation(false);</span>
<span class="fc" id="L1107">        testStep.setIsPhoto(false);</span>
<span class="fc" id="L1108">        testStep.setIsText(false);</span>
<span class="fc" id="L1109">        testStep.setLevel(1);</span>
<span class="fc" id="L1110">        testStep.setParallelism(EnumParallelism.AND);</span>
<span class="fc" id="L1111">        testStep.setIdProcess(testProcess);</span>
<span class="fc" id="L1112">        HibernateUtil.getSession().saveOrUpdate(testStep);</span>
        
        //inserimento del passo nel processo
<span class="fc" id="L1115">        List&lt;Step&gt; testStepList = new ArrayList&lt;Step&gt;();</span>
<span class="fc" id="L1116">        testStepList.add(testStep);</span>
<span class="fc" id="L1117">        testProcess.setSteps(testStepList);</span>
<span class="fc" id="L1118">        HibernateUtil.getSession().saveOrUpdate(testProcess);</span>
        
        //iscrizione dell'utente al processo 
<span class="fc" id="L1121">        Subscription testSubscription = new Subscription();</span>
<span class="fc" id="L1122">        testSubscription.setComplete(false);</span>
<span class="fc" id="L1123">        testSubscription.setIdUser(testUser);</span>
<span class="fc" id="L1124">        testSubscription.setIdProcess(testProcess);</span>
<span class="fc" id="L1125">        HibernateUtil.getSession().saveOrUpdate(testSubscription);     </span>
<span class="fc" id="L1126">	    HibernateUtil.commitTransaction();</span>
        
        //creazione di una data collection
<span class="fc" id="L1129">        DataCollection testCollection = new DataCollection();</span>
<span class="fc" id="L1130">        testCollection.setState(EnumState.TOVERIFY);</span>
<span class="fc" id="L1131">        testCollection.setIdStep(testStep);</span>
<span class="fc" id="L1132">        testCollection.setIdUser(testUser);</span>
<span class="fc" id="L1133">        testCollection.setPhoto(&quot;null&quot;);</span>
<span class="fc" id="L1134">        testCollection.setText(&quot;null&quot;);</span>
<span class="fc" id="L1135">        testCollection.setLongitude(&quot;null&quot;);</span>
<span class="fc" id="L1136">        testCollection.setLatitude(&quot;null&quot;);</span>
    	
<span class="fc" id="L1138">        HibernateUtil.getSession().beginTransaction();</span>
<span class="fc" id="L1139">        daoManagementProcessUserObject.insertDataCollection(testCollection);</span>
<span class="fc" id="L1140">	    HibernateUtil.commitTransaction();</span>
	    
<span class="fc" id="L1142">	    assertNotNull(testCollection);</span>
<span class="fc" id="L1143">    }</span>

}
</pre><div class="footer"><span class="right">Created with <a href="http://www.eclemma.org/jacoco">JaCoCo</a> 0.7.1.201405082137</span>seq (1) (2-lug-2014 22.31.08)</div></body></html>